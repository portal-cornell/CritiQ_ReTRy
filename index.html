<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Multi-Turn Code Generation Through Single Step Rewards">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Multi-Turn Code Generation Through Single Step Rewards</title>

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-RQW73WXYW9"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'G-RQW73WXYW9');
  </script>
  <script type="text/javascript" async 
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
  </script> 

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/icon.jpg">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>

<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">Multi-Turn Code Generation Through Single Step Rewards</h1>

          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://arnavkj1995.github.io/">Arnav Kumar Jain<sup>1</sup> <sup>2</sup></a>,</span>
            <span class="author-block">
              <a href="https://gonzalogonzalezpumariega.com/">Gonzalo Gonzalez-Pumariega<sup>3</sup></a>,</span>
            <span class="author-block">
                <a href="https://www.linkedin.com/in/waynechen314/">Wayne Chen<sup>3</sup></a>,</span>
            <span class="author-block">
                <a href="https://rush-nlp.com/">Alexander M Rush<sup>3</sup></a>,</span>
                <span class="author-block">
                  <a href="https://wenting-zhao.github.io/">Wenting Zhao<sup>3</sup></a>,</span>
            <span class="author-block">
                <a href="https://www.sanjibanchoudhury.com/">Sanjiban Choudhury<sup>3</sup></a>            
          </div>
          <div class="is-size-4">
            <font size="4.5">
            <sup>1</sup>Mila-Quebec AI Institute,  
            <sup>2</sup>Université de Montréal, 
            <sup>3</sup>Cornell University
            </font>
          </div>

          <br>
          <div class="is-size-4">
          <img src="./static/images/mila-logo.png" width="15%" hspace="20" ></img>
          <img src="./static/images/udem-logo.png" width="12%" hspace="20"></img>
          <!-- <img src="./static/images/mcgill-logo.png" width="15%" hspace="20"></img> -->
          <img src="./static/images/cornell-university-logo.png" width="18%" hspace="20"></img>
          </div>
          
          <div class="column has-text-centered">
            
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href=""
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <span class="link-block">
                <a href=""
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/portal-cornell/muCode"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                </a>
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column">
        <!-- <h1 class="title is-3">WRITE TL;DR</h1> -->
        <!-- <br> -->
        <img src="./static/images/key_insight.gif" width="1500">
        </div>
    </div>
    <!-- Dataset -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
          <p style="text-align: left;">
            We address the problem of code generation from multi-turn execution feedback. 
            Existing methods either generate code without feedback or use complex, hierarchical reinforcement learning to optimize multi-turn rewards.
            We propose a simple yet scalable approach, \( \mu \texttt{Code} \), that solves multi-turn code generation using only single-step rewards.
            Our key insight is that code generation is a one-step recoverable MDP, where the correct code can be recovered from any intermediate code state in a single turn.
            \( \mu \texttt{Code} \) iteratively trains both a generator to provide  code solutions conditioned on multi-turn execution feedback and a verifier to score the newly generated code.
            Experimental evaluations show that our approach achieves significant improvements over the state-of-the-art generator-verifier baselines. 
            We provide analysis of the design choices of the reward models and policy, and show the efficacy of \( \mu \texttt{Code} \) at utilizing the execution feedback.
          </p>
      </div>
    </div>
    <br>

    <div class="columns is-centered has-text-centered">
      <div class="column">
        <h2 class="title is-3">\( \mu \texttt{Code} \) Overview</h2>
        <p style="text-align: left;">
          We propose \( \mu \texttt{Code} \), a simple and scalable algorithm for multi-turn code generation using execution feedback.
          \( \mu \texttt{Code} \) follows an expert iteration framework with a local search expert via a learned verifier. 
          \( \mu \texttt{Code} \) iteratively trains two components -- a <i>learned verifier</i> to score code snippets 
          and a <i>generator</i> to imitate the local search. 
          This iterative process allows the generator and expert to bootstrap off each other, leading to continuous improvement.  
          </li>
      </p>
      <br>
        <img src="./static/images/muCode_train.gif" width="1500">
      </div>
    </div> 

    <div class="columns is-centered has-text-centered">
      <div class="column">
        <h2 class="title is-3">Multi-turn Best-of-N Search at Test-time</h2>
        <p style="text-align: left;">
          At inference time, \( \mu \texttt{Code} \) uses both the generator and verifier to improve search and code generations over successive 
          turns with <i>multi-turn Best-of-N (BoN)</i>.
          The generator generates N candidate solutions at each turn which are ranked via the verifier to select the most promising solution.
          In the figure below, we show the top 3 ranked solutions at each turn.
          We observe that the verifier selects the better solution (in orange) at each turn. 
          The selected solution is passed to public tests to retrieve execution feedback for the generator 
          to improve the next code solution.
          The learned verifier gives higher scores to solution with less errors (highlighted in yellow).
          </li>
      </p>
      <br>
        <img src="./static/images/muCode_inference.gif" width="1500">
      
      </div>
    </div> 

    <div class="columns is-centered has-text-centered">
      <div class="column">
        <h2 class="title is-3">Results</h2>
        <p style="text-align: left;">
          Our experiments demonstrate that all multi-turn methods performs better than greedy with the proposed multi-turn BoN approach. 
          Moreover, our proposed method \( \mu \texttt{Code} \) outperforms competing methods based on Llama-3.2-1B-Instruct and Llama-3.1-8B-Instruct models. 
          Here, N=1 denotes greedily generating solutions with 0 temperature. 
          The Best-of-N (BoN) accuracy is computed with N=5 solutions where the combination of public tests and the learned verifier is used for selection.
          The best performance for each dataset and model-size is highlighted in <b>bold</b> and similar performances (within 1%) are <u>underlined</u>.
          </li>
      </p>
      <br>
        <img src="./static/images/Table1.png" width="600">
        <br> <br>
        <p style="text-align: left;">
          We compare different verifiers for multi-turn BoN search at test-time.
          The hierarchical approach of using public tests and the learned verifier (PT+LV) outperforms exclusively using the public tests (PT) or the learned verifier (LV),
          conveying that the learned verifier is a useful signal for inference in addition to public tests.
          The best performance for each dataset and model-size is highlighted in <b>bold</b> and similar performances (within 1%) are <u>underlined</u>.
          </li>
      </p>
      <br>
        <img src="./static/images/Table2.png" width="500">
      </div>
    </div> 
    
</section>

<section class="section">
  <div class="container is-max-desktop">

    <div class="columns is-centered has-text-centered">
      <div class="column" id="Paper">
        <h2 class="title is-3">Paper</h2>
    <div class="paper-thumbnail">
        <a href="">
            <img class="layered-paper-big" width="100%" src="./static/images/preview_muCode.png" alt="Paper thumbnail"/>
        </a>
    </div>
    <div class="paper-info">
        <h3 class="title is-4" style="text-align: center;">BibTex</h3>
<pre style="overflow-x:hidden; text-wrap:wrap; white-space: pre-wrap;"><code>
@article{jain2025multiturncodegeneration},
  title={Multi-Turn Code Generation Through Single Step Rewards},
  author={Arnav Kumar Jain and Gonzalo Gonzalez-Pumariega and Wayne Chen and Alexander M Rush and Wenting Zhao and Sanjiban Choudhury
  },
  year={2025}
}  
</code></pre> 
    </div>
    </div>
</div>
</section>

<footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content has-text-centered">
          <p>
            <a href="https://github.com/portal-cornell/MOSAIC/tree/gh-pages">Fork</a> of a <a href="https://github.com/nerfies/nerfies.github.io">fork</a>.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
